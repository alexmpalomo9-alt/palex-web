<mat-card class="staff-card shadow-sm" [class.dark-theme]="isDarkMode">
  <!-- HEADER CON SECTION-HEADER -->
  <app-section-header
    icon="restaurant_menu"
    title="Personal del Restaurante"
    subtitle="Administra los empleados, roles y permisos del restaurante."
    filterPlaceholder="Buscar empleado..."
    [class.dark-theme]="isDarkMode"
    (search)="onSearch($event)"
  >
    <!-- Botón de acción dentro del header -->
    <app-add-button
      label="Invitar empleado"
      (onClick)="openInvitationDialog()"
      icon="person_add_alt"
    />
  </app-section-header>

  <mat-divider></mat-divider>

  <!-- Cargando indicador -->
  <div *ngIf="isLoading" class="loading-spinner">
    <mat-spinner></mat-spinner>
  </div>

  <!-- ROLES TEMPLATE -->
  <ng-template #rolesTemplate let-user>
    <mat-chip-set class="mt-2">
      <mat-chip
        *ngFor="let r of user.rolesList"
        color="primary"
        selected
        class="chip-role"
      >
        {{ r }}
      </mat-chip>
    </mat-chip-set>
  </ng-template>

  <!-- TABLA -->
  <div class="table-container mt-3">
    <app-base-table
      [columns]="columns"
      [data]="filteredStaff"
      [actionsTemplate]="actionsTemplate"
      filterPlaceholder="Buscar empleado..."
    ></app-base-table>
  </div>

  <!-- ACCIONES -->
  <ng-template #actionsTemplate let-user>
    <div class="actions d-flex align-items-center gap-2">
      <button
        mat-icon-button
        matTooltip="Cambiar rol"
        color="primary"
        (click)="changeRole(user)"
      >
        <mat-icon>manage_accounts</mat-icon>
      </button>

      <button
        mat-icon-button
        matTooltip="Eliminar del restaurante"
        color="warn"
        (click)="deleteStaffMember(user)"
      >
        <mat-icon>person_remove</mat-icon>
      </button>
    </div>
  </ng-template>

  <mat-divider class="my-4"></mat-divider>

  <!-- ROLES Y PERMISOS -->
  <app-role-permissions-info></app-role-permissions-info>
</mat-card>
