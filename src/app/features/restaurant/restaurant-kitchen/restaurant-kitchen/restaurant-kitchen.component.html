<div class="kitchen-container container-fluid kitchen-mode">
  <div class="row g-3">
    <div
      class="col-12 col-md-6 col-lg-4"
      *ngFor="let order of activeOrders$ | async"
    >
      <mat-card class="order-card mat-elevation-z4">
        <!-- HEADER -->
        <mat-card-header
          [ngClass]="{
            'new-order': getStatusLabel(order) === 'Nuevo',
            'updated-order': getStatusLabel(order) === 'Actualizado',
            'preparing-order': getStatusLabel(order) === 'En preparación'
          }"
        >
          <div class="header-left">
            <mat-icon color="primary">table_restaurant</mat-icon>
            <span class="tables">Mesa(s): {{ order.tableNumbers }}</span>
          </div>

          <div class="header-right">
            <span
              *ngIf="getStatusLabel(order)"
              class="status-badge"
              [ngClass]="{
                new: getStatusLabel(order) === 'Nuevo',
                updated: getStatusLabel(order) === 'Actualizado',
                preparing: getStatusLabel(order) === 'En preparación'
              }"
            >
              {{ getStatusLabel(order) }}
            </span>
          </div>
        </mat-card-header>

        <!-- CONTENT -->
        <mat-card-content>
          <div class="info-row">
            <mat-icon>person</mat-icon>
            <span>Creado por: {{ order.waiterName }}</span>
          </div>

          <div class="info-row">
            <mat-icon>payments</mat-icon>
            <span
              >Total: <strong>${{ order.total }}</strong></span
            >
          </div>

          <div class="info-row notes">
            <mat-icon>notes</mat-icon>
            <span>{{ order.notes || "Sin notas" }}</span>
          </div>

          <mat-divider class="my-2"></mat-divider>

          <div class="items">
            <h6 class="items-title">
              <mat-icon>restaurant_menu</mat-icon>
              Items
            </h6>

            <ul class="list-unstyled">
              <li *ngFor="let item of order.items">
                <span class="qty">{{ item.qty }}x</span>
                <span class="name">{{ item.name }}</span>
                <span class="price">${{ item.subtotal }}</span>
              </li>
            </ul>
          </div>
        </mat-card-content>

        <!-- ACTIONS -->
        <mat-card-actions class="actions">
          <button
            mat-flat-button
            color="primary"
            (click)="markPreparing(order)"
            [disabled]="isPreparingDisabled(order)"
          >
            <mat-icon>schedule</mat-icon>
            En preparación
          </button>

          <button
            mat-flat-button
            color="accent"
            (click)="markReady(order)"
            [disabled]="isReadyDisabled(order)"
          >
            <mat-icon>check_circle</mat-icon>
            Listo
          </button>
        </mat-card-actions>
      </mat-card>
    </div>
  </div>
</div>
